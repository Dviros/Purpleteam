# Threat Hunting Session for Quakbot recent behavior (20230222)
Based on observed behaviors from [raw content](https://raw.githubusercontent.com/mthcht/Purpleteam/main/Detection/Threat%20Hunting/qakbot/_raw_20230222.txt)

note: Threat Hunting searches used are meant for Threat Hunting sessions and could generate a lot of false positive if used as detection rules like this.
We need dirty searches for Threat Hunting without Datamodel and optimizations because we want to make sure we match something without depending on the normalization work of the SOC, we can always have a parsing error in DM, service or configuration issue...

### Splunk searches: 
We assume the logs are normalized, replace the fields names with your own mapping...

here we use:
- `process_command` = contain full commandline of process
- `process` = contain process name or path
- `file_name` = contain name of the file or full path with the file name
- `file_path` = contain full path with the name of the file
- `dest_ip` = destination IP address
- `dest_port` = destination port number
- `url` = full url accessed
- `dest_nt_domain` = domain name accessed
- `file_hash` = must contain all type of hashes
- `tag=process` = must contains all log sources with process execution traces
- `tag=proxy` = must contains all log sources with proxy users access traces
- `index=*` = search in all logs sources available

### Useful Keywords:

- url: `"*.dll","*.dat","*.exe","*/t4*","https://transfer.sh/*"`
- dest_nt_domain: `"casualscollection.com","transfer.sh","baracundofres.com","waojernote.com","dns.msftncsi.com"'`
- file_path | file_name | _raw: `"*.one","*362e56855844fb2be3dfae4b566ab676f6ec681fad1c1a2e8eb6d245d56b83f5*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*Djqyxkquei*","*Mairrkitevaj*","*Bourfbyal*","*Eypqhosmv*","28dc02bcd14a49b263705c4cf5fda85734d1f6d401b7ac34b9377610d0597cae","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*1c7829f0316c7aeb94e0887bedf93e3667ab1283659bb1e3d5bcb2860d609ec1*","*Contract_QE20*.one*","*contract 2.one*","*document.one*","*item.one*","*aTgzWLspf.tmp*","*aiaV7JT69.jpg*","*133337.*","*O P E N.*","*Open.jse*","*Open.wsf*","*aNaUlv0y.bat*","*adeP1F.dll*","*\\i.cmd*","* fd.dll*","*default.bat*","*O p e n.bat*","*ngops.bat*","*\\r.cmd*","*\\Temp\\*.bat*","*\\Temp\\*.vbs*","*\\Temp\\*.cmd*","*lesian.dat*","*\\invoice.pdf*","*Feb*_Doc*.one","*Gertiokas*.ocx*","*KYC_CZ21(Feb15).one*","*aaSQMCd.dll*","*aJ1vC.dll*","*C:\\a","*aOQSyY.bat*"`
- process_command: `"*Start-Sleep*","*-C iwr *","* IWR *","* -uri *","*invoke-webrequest*","*regsvr32*.ocx*","*regsvr32*\\Temp\*","*reg.exe*Windows Defender\\Exclusions\\*","*whoami*","*netstat*","*net1.exe*","*net.exe*","*ipconfig*","*cmd /c*","*cmd.exe /c*","*arp -a*","* 2>&1*","*schtasks* /Create*","onenote*\\Temp\\*.one*","*rundll32*.jpg*","*rundll32*.dat*","*.SmcisaK*","*Open.wsf*","*Open.jse*","*\\OneNote\\*.wsf*","*\\OneNote\\*.bat*","*\\OneNote\\*.vbs*","*\\programdata\\*.jpg*","*\\programdata\\*.pdf*","*\\programdata\\*.dat*","*curl -*","*http://*","*https://*","* && rundll32*","*msiexec.exe /V*","*-OutFile *.dat*","*-ExecutionPolicy*","* -ep *","*-WindowStyle hidden*","*route print*"`


#### Behavior searches (specific behavior that could be a used as detection for qakbot):

- **Suspicious OneNote Child Process 2023**
```
tag=process parent_process="*onenote.exe"
AND
(
    process IN ("*AppVLP*","*bash*","*bitsadmin*","*certoc*","*certutil*","*cmd.*","*cmstp*","*control*","*cscript*","*curl*","*forfiles*","*hh.exe*","*ieexec*","*installutil*","*javaw*","*mftrace*","*Microsoft.Workflow.Compiler*","*msbuild*","*msdt*","*mshta*","*msidb*","*msiexec*","*msxsl*","*odbcconf*","*pcalua*","*powershell*","*pwsh*","*regasm*","*regsvcs*","*regsvr32*","*rundll32*","*schtasks*","*scrcons*","*scriptrunner*","*sh.exe*","*svchost*","*verclsid*","*wmic*","*workfolders*","*wscript*","*explorer.exe*")
  OR
    process_command IN ("*AppVLP*","*bash*","*bitsadmin*","*certoc*","*certutil*","*cmd.*","*cmstp*","*control*","*cscript*","*curl*","*forfiles*","*hh.exe*","*ieexec*","*installutil*","*javaw*","*mftrace*","*Microsoft.Workflow.Compiler*","*msbuild*","*msdt*","*mshta*","*msidb*","*msiexec*","*msxsl*","*odbcconf*","*pcalua*","*powershell*","*pwsh*","*regasm*","*regsvcs*","*regsvr32*","*rundll32*","*schtasks*","*scrcons*","*scriptrunner*","*sh.exe*","*svchost*","*netstat*","*net.exe*","*net1.exe*","*verclsid*","*wmic*","*workfolders*","*wscript*","*explorer.exe*","*.hta*","*.vb*","*.wsh*","*.js*","*.ps*","*.scr*","*.pif*","*.bat*","*.jse*","*.cmd*","*https://*,"*http://*","","*\\AppData\\*","*Users\\Public\\*","*ProgramData\\*","*Windows\\Tasks\\*","*Windows\\Temp\\*","*Windows\\System32\\Tasks\\*","*.dat*","*.wsf*","*.vbs*","*.dll*,"*.gif*","*.chm*","*.msi*")
  OR
    file_path IN ("*\\AppData\\*","*Users\\Public\\*","*ProgramData\\*","*Windows\\Tasks\\*","*Windows\\Temp\\*","*Windows\\System32\\Tasks\\*")
)
```

- **HTTP access without domain name**
```
tag=proxy url=* NOT dest IN ("10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16") | regex url = "^(https|tunnel)\:\/\/\d*\.\d*\.\d*\.\d*"
```
---

#### process_command searches:
for this session, we will use these one (extracted from raw file) but can be anything suspicious really (lolbas mostly)
```
tag=process process_command IN ("*Start-Sleep*","*-C iwr *","* IWR *","* -uri *","*invoke-webrequest*","*regsvr32*.ocx*","*regsvr32*\\Temp\*","*reg.exe*Windows Defender\\Exclusions\\*","*whoami*","*netstat*","*net1.exe*","*net.exe*","*ipconfig*","*cmd /c*","*cmd.exe /c*","*arp -a*","* 2>&1*","*schtasks* /Create*","onenote*\\Temp\\*.one*","*rundll32*.jpg*","*rundll32*.dat*","*.SmcisaK*","*Open.wsf*","*Open.jse*","*\\OneNote\\*.wsf*","*\\OneNote\\*.bat*","*\\OneNote\\*.vbs*","*\\programdata\\*.jpg*","*\\programdata\\*.pdf*","*\\programdata\\*.dat*","*curl -*","*http://*","*https://*","* && rundll32*","*msiexec.exe /V*","*-OutFile *.dat*","*-ExecutionPolicy*","* -ep *","*-WindowStyle hidden*","*route print*")
```

#### file_name, file_path searches:
```
index=* file_path IN ("*.one","*362e56855844fb2be3dfae4b566ab676f6ec681fad1c1a2e8eb6d245d56b83f5*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*Djqyxkquei*","*Mairrkitevaj*","*Bourfbyal*","*Eypqhosmv*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*1c7829f0316c7aeb94e0887bedf93e3667ab1283659bb1e3d5bcb2860d609ec1*","*Contract_QE20*.one*","*contract 2.one*","*document.one*","*item.one*","*aTgzWLspf.tmp*","*aiaV7JT69.jpg*","*133337.*","*O P E N.*","*Open.jse*","*Open.wsf*","*aNaUlv0y.bat*","*adeP1F.dll*","*\\i.cmd*","* fd.dll*","*default.bat*","*O p e n.bat*","*ngops.bat*","*\\r.cmd*","*\\Temp\\*.bat*","*\\Temp\\*.vbs*","*\\Temp\\*.cmd*","*lesian.dat*","*\\invoice.pdf*","*Feb*_Doc*.one","*Gertiokas*.ocx*","*KYC_CZ21(Feb15).one*","*aaSQMCd.dll*","*aJ1vC.dll*","*C:\\a","*aOQSyY.bat*") 
OR file_name IN ("*.one","*362e56855844fb2be3dfae4b566ab676f6ec681fad1c1a2e8eb6d245d56b83f5*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*Djqyxkquei*","*Mairrkitevaj*","*Bourfbyal*","*Eypqhosmv*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24*","*1c7829f0316c7aeb94e0887bedf93e3667ab1283659bb1e3d5bcb2860d609ec1*","*Contract_QE20*.one*","*contract 2.one*","*document.one*","*item.one*","*aTgzWLspf.tmp*","*aiaV7JT69.jpg*","*133337.*","*O P E N.*","*Open.jse*","*Open.wsf*","*aNaUlv0y.bat*","*adeP1F.dll*","*\\i.cmd*","* fd.dll*","*default.bat*","*O p e n.bat*","*ngops.bat*","*\\r.cmd*","*\\Temp\\*.bat*","*\\Temp\\*.vbs*","*\\Temp\\*.cmd*","*lesian.dat*","*\\invoice.pdf*","*Feb*_Doc*.one","*Gertiokas*.ocx*","*KYC_CZ21(Feb15).one*","*aaSQMCd.dll*","*aJ1vC.dll*","*C:\\a","*aOQSyY.bat*") 
```

#### url, dest_nt_domain searches:
```
tag=proxy url IN ("*.dll","*.dat","*.exe","*/t4","https://transfer.sh/*") OR dest_nt_domain IN ("*casualscollection.com","*transfer.sh","*baracundofres.com","*waojernote.com","dns.msftncsi.com")
```

#### file_hash searches:
```
index=* file_hash IN ("518518b0929911353cd7ab95d873e1fb290d8a494122cfb88e7f8bcf015576c8","0dbc95d60b957669b5ae6e6977bae478738209fdb51dff780121320d6248b8e7","0415ef433261d715e36a1d6497ebe78dd1fb7dcc45e018e5a95def1572e47272","1fc89115c1f5d0aff030811ef827d60ba474819dcea5f4e53b9e3a2c3f29604a","283fed02e9434975e43435a8748ab01451199a061da32e94e39128fd7745db24","6f99171c95a8ed5d056eeb9234dbbee123a6f95f481ad0e0a966abd2844f0e1a","7dd17b8cb0639732fe6929a5d7e1431fedae58acd401a7810afc0be8f9c42ad0","b91340d156582060095227e8d26f29f5ffc8b0e8fbf35a392b649adc60a5d4ab","be7e0c5b7566efa2d8b39bada9bd9e114f8ccc27c71327026f616e85bb2adb30","d53a72da6f43cc8b0a7adca3e397addfccfb1d6e9650184f76afc294b66f98a1","e16e0faae0e9851a782d026f6692e34a9c7bae14c545aa8ac1e1ef033dfd06a8","e99726f967f112c939e4584350a707f1a3885c1218aafa0f234c4c30da8ba2af","7427d5bcdd548f6bc47b6f776f1f157e23619be3814d3da7c0f0e234306fb39a","362e56855844fb2be3dfae4b566ab676f6ec681fad1c1a2e8eb6d245d56b83f5","4a77f8bca1eb72556e1d9f1eeb2568a2d5c27a0a686d3c8e0635aefc7723144","62072293339168c6296c56c17686172e4d3110c5ba25fe86c5cfa99765be8441","6778c59a29e25d722230163bea272ece58d2d3696fbce4347c20104e8fb735dc","7d84269a8ca5defbf09323180aca1ea7a26eea614fda04d3367c2fac2783a26c","907e1edfdd6879afe9edde05b7afda3ceae6cecbb99588c31dcd4035447837fd","f8360776618ae88f15187275a0222863ad44565568a71e02626a0ff351e3ef9a","b0e55ee7e05134855eb70ac1744370b78743818c106e389de7e0b614a2c37d2d","fe7c6af8a14af582c3f81749652b9c1ea6c0c002bb181c9ffb154eae609e6458","1c7829f0316c7aeb94e0887bedf93e3667ab1283659bb1e3d5bcb2860d609ec1","71805df6272036ba19ea6d4b91c03e9f7e11e2ab67e54724c0dba959c5392467","1b3b1a86a4344b79d495b80a18399bb0d9f877095029bb9ead2fcc7664e9e89c","1f3815d7c08a74449847326cae3c4f8e44ebd576c84d76a8c1431dc9abd7b5cc","bdfee1ccabe10bc2600f4c184ec7e9a5496d646b2df8f17d4d96e0c89a40aca2","81b85d5cd1ec4a116e04ff56d509f9bbd3cac0dd9fb695346340a6ccd3dde43d","997953548ccaf132f260b69dcd56dd56a2dc8028b4da3e6b99a2133ca2486039","45bc916a4e4573cdf9c5e86b1320e8173de9eeee1ad9be0f30378977a6e54ce1")
```

#### dest_ip, dest_port searches:
```
tag=network dest_ip=102.156.253.86 dest_port=443) OR (dest_ip=103.111.70.115 dest_port=443) OR (dest_ip=103.111.70.115 dest_port=995) OR (dest_ip=103.12.133.134 dest_port=2222) OR (dest_ip=103.123.223.168 dest_port=443) OR (dest_ip=103.123.223.76 dest_port=443) OR (dest_ip=103.140.174.19 dest_port=2222) OR (dest_ip=103.141.50.102 dest_port=995) OR (dest_ip=103.144.201.53 dest_port=2078) OR (dest_ip=103.212.19.254 dest_port=995) OR (dest_ip=103.231.216.238 dest_port=443) OR (dest_ip=103.252.7.231 dest_port=443) OR (dest_ip=103.42.86.110 dest_port=995) OR (dest_ip=103.42.86.238 dest_port=995) OR (dest_ip=104.35.24.154 dest_port=443) OR (dest_ip=107.146.12.26 dest_port=2222) OR (dest_ip=108.190.203.42 dest_port=995) OR (dest_ip=109.11.175.42 dest_port=2222) OR (dest_ip=109.149.147.146 dest_port=2222) OR (dest_ip=109.150.179.236 dest_port=2222) OR (dest_ip=109.151.144.37 dest_port=443) OR (dest_ip=114.143.176.234 dest_port=443) OR (dest_ip=114.79.180.14 dest_port=995) OR (dest_ip=114.92.98.210 dest_port=995) OR (dest_ip=116.72.250.18 dest_port=443) OR (dest_ip=116.74.164.26 dest_port=443) OR (dest_ip=116.74.164.67 dest_port=443) OR (dest_ip=116.75.63.166 dest_port=443) OR (dest_ip=119.155.227.81 dest_port=995) OR (dest_ip=12.172.173.82 dest_port=20) OR (dest_ip=12.172.173.82 dest_port=2087) OR (dest_ip=12.172.173.82 dest_port=21) OR (dest_ip=12.172.173.82 dest_port=32101) OR (dest_ip=12.172.173.82 dest_port=465) OR (dest_ip=12.172.173.82 dest_port=50001) OR (dest_ip=12.172.173.82 dest_port=990) OR (dest_ip=12.172.173.82 dest_port=995) OR (dest_ip=121.121.100.207 dest_port=995) OR (dest_ip=122.184.143.82 dest_port=443) OR (dest_ip=123.3.240.16 dest_port=995) OR (dest_ip=124.122.56.144 dest_port=443) OR (dest_ip=125.99.69.178 dest_port=443) OR (dest_ip=136.232.184.134 dest_port=995) OR (dest_ip=136.244.25.165 dest_port=443) OR (dest_ip=136.35.241.159 dest_port=443) OR (dest_ip=139.5.239.14 dest_port=443) OR (dest_ip=14.192.241.76 dest_port=995) OR (dest_ip=142.182.109.233 dest_port=2222) OR (dest_ip=144.202.2.175) OR (dest_ip=147.182.206.33) OR (dest_ip=147.219.4.194 dest_port=443) OR (dest_ip=149.74.159.67 dest_port=2222) OR (dest_ip=150.107.231.59 dest_port=2222) OR (dest_ip=151.65.224.211 dest_port=443) OR (dest_ip=156.216.125.255 dest_port=995) OR (dest_ip=161.142.107.68 dest_port=995) OR (dest_ip=162.248.14.107 dest_port=443) OR (dest_ip=165.22.160.25) OR (dest_ip=171.96.205.252 dest_port=443) OR (dest_ip=172.248.42.122 dest_port=443) OR (dest_ip=173.178.151.233 dest_port=443) OR (dest_ip=173.18.126.3 dest_port=443) OR (dest_ip=174.104.184.149 dest_port=443) OR (dest_ip=174.58.146.57 dest_port=443) OR (dest_ip=176.142.207.63 dest_port=443) OR (dest_ip=179.43.154.184) OR (dest_ip=180.151.108.14 dest_port=443) OR (dest_ip=181.118.206.65 dest_port=995) OR (dest_ip=181.164.217.211 dest_port=443) OR (dest_ip=182.180.105.242 dest_port=443) OR (dest_ip=183.87.163.165 dest_port=443) OR (dest_ip=184.176.35.223 dest_port=2222) OR (dest_ip=184.68.116.146 dest_port=3389) OR (dest_ip=184.68.116.146 dest_port=61202) OR (dest_ip=185.249.85.209) OR (dest_ip=185.81.113.214) OR (dest_ip=188.83.248.76 dest_port=443) OR (dest_ip=190.11.198.74 dest_port=443) OR (dest_ip=190.11.198.75 dest_port=443) OR (dest_ip=190.123.44.144 dest_port=4444) OR (dest_ip=190.206.75.58 dest_port=2222) OR (dest_ip=190.75.95.164 dest_port=2222) OR (dest_ip=193.253.100.236 dest_port=2222) OR (dest_ip=194.166.93.69 dest_port=443) OR (dest_ip=197.0.251.32 dest_port=443) OR (dest_ip=197.1.134.46 dest_port=443) OR (dest_ip=197.26.145.223 dest_port=443) OR (dest_ip=197.92.136.122 dest_port=443) OR (dest_ip=198.2.51.242 dest_port=993) OR (dest_ip=2.13.73.146 dest_port=2222) OR (dest_ip=2.50.47.74 dest_port=443) OR (dest_ip=2.50.48.213 dest_port=443) OR (dest_ip=2.99.47.198 dest_port=2222) OR (dest_ip=201.142.207.183 dest_port=443) OR (dest_ip=201.244.108.183 dest_port=995) OR (dest_ip=202.142.98.62 dest_port=443) OR (dest_ip=202.142.98.62 dest_port=995) OR (dest_ip=202.186.177.88 dest_port=443) OR (dest_ip=202.187.232.161 dest_port=995) OR (dest_ip=205.164.227.222 dest_port=443) OR (dest_ip=208.180.17.32 dest_port=2222) OR (dest_ip=209.140.8.70 dest_port=443) OR (dest_ip=209.142.97.83 dest_port=995) OR (dest_ip=210.84.30.161 dest_port=443) OR (dest_ip=213.31.90.183 dest_port=2222) OR (dest_ip=213.67.255.57 dest_port=2222) OR (dest_ip=216.228.41.244 dest_port=2222) OR (dest_ip=217.128.200.114 dest_port=2222) OR (dest_ip=217.128.91.196 dest_port=2222) OR (dest_ip=217.165.1.53 dest_port=2222) OR (dest_ip=217.165.186.116 dest_port=2222) OR (dest_ip=23.106.124.9) OR (dest_ip=24.206.27.39 dest_port=443) OR (dest_ip=24.228.132.224 dest_port=2222) OR (dest_ip=24.239.69.244 dest_port=443) OR (dest_ip=24.64.112.40 dest_port=2222) OR (dest_ip=24.64.112.40 dest_port=3389) OR (dest_ip=24.64.112.40 dest_port=61202) OR (dest_ip=24.69.84.237 dest_port=443) OR (dest_ip=24.71.120.191 dest_port=443) OR (dest_ip=24.9.220.167 dest_port=443) OR (dest_ip=27.0.48.205 dest_port=443) OR (dest_ip=27.0.48.233 dest_port=443) OR (dest_ip=27.109.19.90 dest_port=2078) OR (dest_ip=27.99.45.237 dest_port=2222) OR (dest_ip=31.166.48.125 dest_port=995) OR (dest_ip=31.53.29.145 dest_port=2222) OR (dest_ip=35.143.97.145 dest_port=995) OR (dest_ip=37.14.229.220 dest_port=2222) OR (dest_ip=37.56.105.165 dest_port=995) OR (dest_ip=41.228.236.143 dest_port=995) OR (dest_ip=41.99.50.76 dest_port=443) OR (dest_ip=45.246.235.113 dest_port=995) OR (dest_ip=45.50.233.214 dest_port=443) OR (dest_ip=46.10.198.107 dest_port=443) OR (dest_ip=46.24.103.218 dest_port=2078) OR (dest_ip=46.27.231.50 dest_port=2078) OR (dest_ip=47.149.78.242 dest_port=443) OR (dest_ip=47.21.51.138 dest_port=443) OR (dest_ip=47.21.51.138 dest_port=995) OR (dest_ip=47.34.30.133 dest_port=443) OR (dest_ip=49.175.72.56 dest_port=443) OR (dest_ip=49.245.82.178 dest_port=2222) OR (dest_ip=49.50.84.164) OR (dest_ip=49.50.84.164 dest_port=80) OR (dest_ip=5.193.84.234 dest_port=2222) OR (dest_ip=50.67.17.92 dest_port=443) OR (dest_ip=50.68.186.195 dest_port=443) OR (dest_ip=50.68.204.71 dest_port=443) OR (dest_ip=50.68.204.71 dest_port=993) OR (dest_ip=50.68.204.71 dest_port=995) OR (dest_ip=51.222.199.226) OR (dest_ip=51.222.199.226 dest_port=80) OR (dest_ip=58.186.75.42 dest_port=443) OR (dest_ip=58.247.115.126 dest_port=995) OR (dest_ip=59.28.84.65 dest_port=443) OR (dest_ip=62.35.100.38 dest_port=443) OR (dest_ip=62.35.67.88 dest_port=443) OR (dest_ip=64.225.8.202) OR (dest_ip=64.237.185.60 dest_port=443) OR (dest_ip=66.191.69.18 dest_port=995) OR (dest_ip=66.35.126.223 dest_port=2222) OR (dest_ip=67.10.175.47 dest_port=2222) OR (dest_ip=67.187.130.101 dest_port=443) OR (dest_ip=67.43.234.56) OR (dest_ip=67.61.71.201 dest_port=443) OR (dest_ip=68.108.122.180 dest_port=443) OR (dest_ip=68.150.18.161 dest_port=443) OR (dest_ip=68.173.170.110 dest_port=8443) OR (dest_ip=69.133.162.35 dest_port=443) OR (dest_ip=70.160.80.210 dest_port=443) OR (dest_ip=70.27.104.2 dest_port=2222) OR (dest_ip=70.51.153.37 dest_port=2222) OR (dest_ip=70.64.77.115 dest_port=443) OR (dest_ip=70.77.116.233 dest_port=443) OR (dest_ip=71.112.212.166 dest_port=443) OR (dest_ip=71.212.147.224 dest_port=2222) OR (dest_ip=71.31.101.183 dest_port=443) OR (dest_ip=71.52.53.166 dest_port=443) OR (dest_ip=72.188.103.221 dest_port=443) OR (dest_ip=72.188.121.121 dest_port=443) OR (dest_ip=72.194.232.94 dest_port=443) OR (dest_ip=72.200.109.104 dest_port=443) OR (dest_ip=72.203.216.98 dest_port=2222) OR (dest_ip=72.80.7.6 dest_port=50003) OR (dest_ip=72.80.7.6 dest_port=995) OR (dest_ip=72.80.94.230 dest_port=443) OR (dest_ip=72.88.245.71 dest_port=443) OR (dest_ip=73.161.176.218 dest_port=443) OR (dest_ip=73.165.119.20 dest_port=443) OR (dest_ip=73.29.92.128 dest_port=443) OR (dest_ip=73.36.196.11 dest_port=443) OR (dest_ip=73.78.215.104 dest_port=443) OR (dest_ip=74.33.196.114 dest_port=443) OR (dest_ip=74.58.71.237 dest_port=443) OR (dest_ip=74.92.243.113 dest_port=50000) OR (dest_ip=74.93.148.97 dest_port=995) OR (dest_ip=75.141.227.169 dest_port=443) OR (dest_ip=75.143.236.149 dest_port=443) OR (dest_ip=75.156.125.215 dest_port=995) OR (dest_ip=75.158.15.211 dest_port=443) OR (dest_ip=75.98.154.19 dest_port=443) OR (dest_ip=76.170.252.153 dest_port=995) OR (dest_ip=76.20.42.45 dest_port=443) OR (dest_ip=76.64.202.44 dest_port=2222) OR (dest_ip=76.80.180.154 dest_port=995) OR (dest_ip=77.124.6.149 dest_port=443) OR (dest_ip=77.86.98.236 dest_port=443) OR (dest_ip=78.130.215.67 dest_port=443) OR (dest_ip=78.16.206.181 dest_port=443) OR (dest_ip=78.218.230.28 dest_port=443) OR (dest_ip=78.84.123.237 dest_port=995) OR (dest_ip=79.67.165.149 dest_port=995) OR (dest_ip=80.0.74.165 dest_port=443) OR (dest_ip=80.13.205.69 dest_port=2222) OR (dest_ip=80.47.57.131 dest_port=2222) OR (dest_ip=81.151.102.224 dest_port=443) OR (dest_ip=81.157.202.71 dest_port=995) OR (dest_ip=81.157.227.223 dest_port=2222) OR (dest_ip=81.229.117.95 dest_port=2222) OR (dest_ip=82.121.195.187 dest_port=2222) OR (dest_ip=82.127.204.82 dest_port=2222) OR (dest_ip=82.212.115.188 dest_port=443) OR (dest_ip=83.7.53.157 dest_port=443) OR (dest_ip=83.7.54.170 dest_port=443) OR (dest_ip=84.108.200.161 dest_port=443) OR (dest_ip=84.215.202.22 dest_port=443) OR (dest_ip=84.219.213.130 dest_port=6881) OR (dest_ip=84.35.26.14 dest_port=995) OR (dest_ip=85.231.105.49 dest_port=2222) OR (dest_ip=85.241.180.94 dest_port=443) OR (dest_ip=85.59.61.52 dest_port=2222) OR (dest_ip=85.61.165.153 dest_port=2222) OR (dest_ip=85.74.149.3 dest_port=2222) OR (dest_ip=85.85.34.201 dest_port=993) OR (dest_ip=86.130.9.146 dest_port=2222) OR (dest_ip=86.130.9.232 dest_port=2222) OR (dest_ip=86.138.7.220 dest_port=2222) OR (dest_ip=86.150.47.219 dest_port=443) OR (dest_ip=86.169.203.116 dest_port=443) OR (dest_ip=86.176.144.213 dest_port=2222) OR (dest_ip=86.188.32.131 dest_port=443) OR (dest_ip=86.195.14.72 dest_port=2222) OR (dest_ip=86.196.12.21 dest_port=2222) OR (dest_ip=86.202.48.142 dest_port=2222) OR (dest_ip=86.207.227.152 dest_port=2222) OR (dest_ip=86.225.214.138 dest_port=2222) OR (dest_ip=86.236.114.212 dest_port=2222) OR (dest_ip=86.250.12.217 dest_port=2222) OR (dest_ip=86.96.72.139 dest_port=2222) OR (dest_ip=86.99.54.39 dest_port=2222) OR (dest_ip=87.149.176.97 dest_port=443) OR (dest_ip=87.202.101.164 dest_port=50000) OR (dest_ip=87.221.197.113 dest_port=2222) OR (dest_ip=87.223.82.41 dest_port=443) OR (dest_ip=87.243.146.59 dest_port=443) OR (dest_ip=87.57.13.215 dest_port=443) OR (dest_ip=88.111.182.118 dest_port=2222) OR (dest_ip=88.126.112.14 dest_port=50000) OR (dest_ip=88.126.94.4 dest_port=50000) OR (dest_ip=89.129.109.27 dest_port=2222) OR (dest_ip=89.152.120.181 dest_port=443) OR (dest_ip=89.32.157.195 dest_port=995) OR (dest_ip=89.32.159.192 dest_port=995) OR (dest_ip=89.79.229.50 dest_port=443) OR (dest_ip=90.104.22.28 dest_port=2222) OR (dest_ip=90.165.109.4 dest_port=2222) OR (dest_ip=90.213.146.227 dest_port=443) OR (dest_ip=90.78.138.217 dest_port=2222) OR (dest_ip=91.165.188.74 dest_port=50000) OR (dest_ip=91.170.115.68 dest_port=32100) OR (dest_ip=91.254.132.23 dest_port=443) OR (dest_ip=91.68.227.219 dest_port=443) OR (dest_ip=92.154.17.149 dest_port=2222) OR (dest_ip=92.154.45.81 dest_port=2222) OR (dest_ip=92.17.122.33 dest_port=2222) OR (dest_ip=92.186.69.229 dest_port=2222) OR (dest_ip=92.239.81.124 dest_port=443) OR (dest_ip=92.27.86.48 dest_port=2222) OR (dest_ip=92.57.227.146 dest_port=2222) OR (dest_ip=92.97.197.177 dest_port=2222) OR (dest_ip=92.97.203.51 dest_port=2222) OR (dest_ip=93.147.235.8 dest_port=443) OR (dest_ip=93.156.99.48 dest_port=443) OR (dest_ip=93.24.192.142 dest_port=20) OR (dest_ip=94.105.123.142 dest_port=443) OR (dest_ip=94.30.98.134 dest_port=32100) OR (dest_ip=94.59.56.206 dest_port=2222) OR (dest_ip=95.150.121.151 dest_port=443) OR (dest_ip=95.242.101.251 dest_port=995) OR (dest_ip=95.255.60.223 dest_port=995) OR (dest_ip=95.94.41.77 dest_port=2222) OR (dest_ip=97.93.192.2 dest_port=2083) OR (dest_ip=98.145.23.67 dest_port=443) OR (dest_ip=98.147.155.235 dest_port=443) OR (dest_ip=98.163.227.79 dest_port=443) OR (dest_ip=98.22.28.34 dest_port=995) OR (dest_ip=98.37.25.99 dest_port=443)
```

#### unlimited power search x) :
1.upload keywords_list.csv to your SIEM
2.create a lookup definition named keywords_list for keywords_list.csv and add WILDCARD(keyword) in the advanced option of the lookup for this search to work, modify permissions of the lookup to be able to read it
3.
```
index=* | lookup keywords_list keyword as _raw OUTPUT keyword as keyword_detection 
| stats count ealiest(_time) as firsttime latest(_time)- as lasttime values(_raw) by keyword_detection index sourcetype 
| convert ctime(*time)
```
